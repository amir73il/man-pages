#!/bin/bash
#
# Copyright 2024-2025, Alejandro Colomar <alx@kernel.org>
# SPDX-License-Identifier: GPL-3.0-or-later

set -Eeuo pipefail;

# diff all modified pages against the system ones.

cd $(git rev-parse --show-toplevel);

git diff --name-only \
| grep -E '(\.[[:digit:]]([[:alpha:]][[:alnum:]]*)?\>|\.man)+(\.man|\.in)*$' \
| sortman \
| while read f; do \
	sys="$(basename "$f")";

	diffman "$@" "$sys" "$f" || true;
done \
| less -R;
